
# CaptchaRecognizer 功能文档

## 项目概述

CaptchaRecognizer是一款基于深度学习的验证码识别浏览器插件，通过前端捕获网页验证码，后端调用模型识别并返回结果的方式实现自动填写验证码功能。

## 系统架构

项目分为三个模块：
- **model**：深度学习模型模块
- **extension**：浏览器扩展前端（wxt+vue+ts+pinia+element plus）
- **server**：后端服务（fastapi+mysql）

## 核心功能

### 1. 验证码定位系统

#### 1.1 CaptchaRecord数据结构
- 网站信息（域名、路径等）
- 验证码元素选择器
- 验证码类型（字符型、滑块型等）
- 关联元素信息（输入框、滑块等）
- 元数据（上传人、上传时间、成功率）
- 额外属性（extra字段）

#### 1.2 验证码元素选择器
- 类浏览器控制台的元素选择功能
- 悬停元素自动高亮显示
- 浮动信息面板显示元素属性
- 点击元素固定选择，避免刷新验证码
- 重新选择、取消选择（Esc键）功能
- 基于匹配度的上传控制

#### 1.3 验证码特征识别系统
- 特征评分链设计
- 字符型验证码特征：
  - 元素类型（图片）
  - 尺寸范围检查
  - 属性关键词检测（src/id/alt包含captcha/code/verify等）
  - 相邻输入框特征检测
  - 刷新按钮特征识别
- 匹配度计算与阈值控制
- 可扩展的验证码类型匹配链

### 2. 自动识别与填写系统

#### 2.1 本地缓存管理
- Record本地存储与更新机制
- 失效记录处理策略

#### 2.2 验证码识别流程
- 页面加载检测
- 本地缓存查询
- 服务器Record获取
- 验证码元素定位
- 图像获取与预处理
- 后端识别请求
- 结果回填

#### 2.3 监控与纠错机制
- 验证码元素变化监听
- 错误次数统计
- 错误阈值控制
- 用户手动干预处理
- 反馈收集机制

### 3. 后端服务

#### 3.1 API设计
- Record管理接口
- 验证码识别接口
- 用户反馈接口

#### 3.2 数据存储
- CaptchaRecord表设计
- 用户数据管理
- 识别历史记录

#### 3.3 模型调用
- 模型服务集成
- 识别结果处理
- 性能优化策略

### 4. 错误处理与日志系统

#### 4.1 错误处理机制
- 前端异常捕获
- 后端错误响应
- 降级策略

#### 4.2 日志系统
- 操作日志
- 错误日志
- 性能监控
- 用户行为分析

#### 4.3 用户反馈系统
- 识别失败反馈
- Record失效反馈
- 用户体验改进建议

## 技术实现路线图

### 第一阶段：基础功能实现
- 验证码元素选择器开发
- CaptchaRecord设计与存储
- 字符验证码识别流程实现

### 第二阶段：优化与扩展
- 错误处理机制完善
- 本地缓存优化
- 用户反馈系统实现

### 第三阶段：功能扩展
- 支持更多验证码类型
- 性能优化与安全加固
- 社区贡献机制设计
